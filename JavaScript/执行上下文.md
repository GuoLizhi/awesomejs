### 1. 执行上下文

JavaScript中有三种执行上下文

1. 全局执行上下文。创建全局的window对象，并设置this指向这个对象。
2. 函数执行上下文。每当一个函数被调用都会创建一个新的上下文，每个函数都有自己的上下文，在函数被调用时才会创建。
3. eval函数执行上下文。执行eval函数内部的代码也会有它属于自己的执行上下文

### 2. 执行栈

JavaScript执行栈遵循LIFO后进先出的原则，用来存储代码运行时创建的所有执行上下文。

当JavaScript引擎第一次遇到你的脚本时，它会创建一个全局执行上下文并且压入当前执行栈，然后当遇到函数调用时，会创建一个新的函数执行上下文并压入栈的顶部，当函数执行完毕，该函数执行上下文就会出栈。

<img src="http://cdn.lznism.com/20201225_01.png" style="zoom:80%;" />

### 3. 创建执行上下文

该过程有两个阶段

1. 创建阶段
2. 执行阶段

创建阶段会发生三件事情

1. this绑定：全局执行上下文中，this指向全局对象。函数执行上下文中，this取决于函数运行时的调用对象
2. 创建词法环境组件：词法环境是一种持有标识符-变量映射的结构（这里的标识符是指变量或者函数的名字，而变量是对实际对象或原始数据的引用）。词法环境内部有两个组件：`环境记录器`是存储变量和函数声明的实际位置。`外部环境的引用`意味着它可以访问父级词法环境
3. 创建变量环境组件：变量环境也是一个词法环境，所以它有着所有词法环境组件的属性。在ES6中，词法环境用来存储变量声明和变量let,const绑定，而变量环境用来存储var变量的绑定

```c++
ExecutionContext = {
  	ThisBinding = <this value>
    LexicalEnvironment
    VariableEnvironment
}
```

执行阶段：完成对变量的分配，最后执行代码